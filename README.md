# Chiral Client in Java

## Add chiral-client in your project 

### Maven

1. add a repository in ```pom.xml```
```xml
<repositories>
    <repository>
        <id>clientlib</id>
        <url>https://maven.fury.io/chiral/</url>
    </repository>
</repositories>
```

2. add the dependency ```clientlib```, latest version: 0.2.2
```xml
  <dependencies>
    <dependency>
      <groupId>com.chiral.client</groupId>
      <artifactId>clientlib</artifactId>
      <version>0.2.2</version>
    </dependency>
  </dependencies>
```

## Client APIs 

```java
// class ClientBuilder
public static Client build(String email, String apiToken) throws ChiralException
// Client object is constructed by calling ClientBuilder.build()
// The parameters 'email' and 'apiToken' can be acquired from our website "cloud.chiral.one" after registration.

// class Client
public void waitUntilCompletion(String jobId) throws JsonProcessingException, InterruptedException 
// Check the job status every 500 milliseconds until the job is completed
//      - jobId: the Job ID returned after the job submital.

```

## Chiral Computing Cloud APIs for Gromacs

*** Attentions: File storage for users ***

Software like gromacs requires input files and generates output files when simulations are carried out. Chiral provides a storage space to each registered user for file transfering.

Input files will be uploaded from user side to chiral cloud, meanwhile output files will be available for being downloaded by the users.

```java
public JobManager(String simulationId, String localDirectory)
// Construct a JobManager for Gromacs
// Parameters:
//      - simulationId: user-defined simulation id, all related files of the simulation with this ID will be saved under "gromacs/simulationId" in the file storage space in cloud. 
//      - localDirectory: all related files of the simulation will be saved under this directory locally.

public void uploadFiles(Client client, String[] files) throws IOException {}
// Upload Files
//      - client: an initialized com.chiral.client.Client
//      - files: files to be uploaded

public void downloadFiles(Client client, String[] files) throws IOException {}
// Download Files
//      - client: an initialized com.chiral.client.Client
//      - files: files to be downloaded 

public void clearFiles(Client client) throws IOException {}
// Clear all the contents under gromacs/simulationId and then rmove the empty directory "gromacs/simulationId"
//      - client: an initialized com.chiral.client.Client

public String submitJob(Client client, String subCommand, String arguments, String prompts, String[] filesInput, String[] filesOutput) throws JsonProcessingException {}
//  Submit a gromacs job
//      - client: an instance of com.chiral.client.Client
//      - subCommand: gromacs subcommand such as "mdrun", "grompp", etc.
//      - arguments: command arguments
//      - prompts: user inputs after the command starts.
//      - filesInput: files required as input for the command.  
//      - filesOutput: files generated by the command and saved in the storage space. files not listed will be discarded. 
//  returns a String as the Job ID.

public Output getOutput(Client client, String jobId) throws JsonProcessingException, ChiralException
// Class Output has three variables
//      - stdout: the standard output of the command from the job.
//      - stderr: the error output of the command from the job.
//  This method can be used to get more information about the gromacs command execution. For example, if the job is not successfully completed, users can retrieve useful information from Output.stderr to identify the root cause of failure. 
//  When there are errors, a ChiralException will be thrown out.
```

### Examples
- Examples can be found from ```GromacsTest.java``` including a full simulation tutorial of gromacs for lysozyme (egg white) in water.
- All the inputs files required by this examples can be found from ```files/lysozyme```.


## Chiral Computing Cloud APIs for ReCGen 

```java
public JobManager(String db_file)
// Construct a JobManager for ReCGen 
//    - db_file: file name of fragment database, two available options are "DrugBank_M.db" and "kegg_drug220912.db"

public String submitJob(Client client, String mol) throws JsonProcessingException
// Submit a recgen job
//      - client: an instance of com.chiral.client.Client
//      - mol: the content of .mol file for a molecule
//  returns a String as the Job ID.

public ArrayList<String> getOutput(Client client, String jobId) throws JsonProcessingException, JsonMappingException, ChiralException
// Retrieve the job result 
//      - client: an instance of com.chiral.client.Client
//      - jobId: job ID
//  returns a list of Strings, each String represents a molecule in SMILES.
//  When there are errors, a ChiralException will be thrown out.
```

### Examples
- Examples can be found from ```RecgenTest.java```. 
- All the inputs files required by this examples can be found from ```files/recgen```.


## Chiral Computing Cloud APIs for Llama2 

Llma2 is [an open source large language model from Meta](https://about.fb.com/news/2023/07/llama-2/).

```java
public JobManager()
// Construct a JobManager for ReCGen 

public String submitJob(Client client, double temperature, String prompt) throws JsonProcessingException
// Submit a llama2 job
//      - temperature: creativity parameter for llama2
//      - prompt: the starting phrase 
//  returns a String as the Job ID.

public Output getOutput(Client client, String jobId) throws JsonProcessingException, ChiralException
// Retrieve the job result
//      - client: an instance of com.chiral.client.Client
//      - jobId: job ID
//  returns an Output instance which including the generated text.
//  When there are errors, a ChiralException will be thrown out.
```

### Examples
- Examples can be found from ```Llama2Test.java```. 